{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "ConfigMaps",
            "group": "build",
            "type": "shell",
            "command": "kubectl apply -f infrastructure/configMaps && kubectl apply -f infrastructure/configMaps-dev && kubectl apply -f monitoring/configMaps && kubectl apply -f monitoring/configMaps-dev"
        },
        {
            "label": "Secrets",
            "group": "build",
            "type": "shell",
            "command": "kubectl apply -f infrastructure/secrets-dev && kubectl apply -f monitoring/secrets-dev"
        },
        {
            "label": "Enable Ingress",
            "group": "build",
            "type": "shell",
            "command": "minikube addons enable ingress"
        },
        {
            "label": "Build Grafana",
            "group": "build",
            "type": "shell",
            "command": "eval $(minikube docker-env) && docker build monitoring -f monitoring/Dockerfile.grafana -t grafana-custom"
        },
        {
            "label": "Build User",
            "group": "build",
            "type": "shell",
            "command": "eval $(minikube docker-env) && docker build user -f user/Dockerfile -t python-custom"
        },
        {
            "label": "Build Teacher",
            "group": "build",
            "type": "shell",
            "command": "eval $(minikube docker-env) && docker build teacher-panel -f teacher-panel/Dockerfile -t node-custom"
        },
        {
            "label": "Init",
            "group": "build",
            "type": "shell",
            "dependsOn":["Enable Ingress", "Build Grafana", "Build User", "Build Teacher", "ConfigMaps", "Secrets"]
        },
        {
            "label": "Deploy",
            "group": "build",
            "type": "shell",
            "dependsOn":["Init"],
            "command": "kubectl apply -f infrastructure/k8s && kubectl apply -f monitoring/k8s && kubectl apply -f frontend.yaml"
        }
  ]
}
